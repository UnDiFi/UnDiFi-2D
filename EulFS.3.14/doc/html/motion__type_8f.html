<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>eulfs: src/geometry/motion_type.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">eulfs
   &#160;<span id="projectnumber">3.11</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('motion__type_8f.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">motion_type.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a316d52085cfea0d96fe7dc73723b6723"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motion__type_8f.html#a316d52085cfea0d96fe7dc73723b6723">MOVEXYZ</a> (XYZ0, XYZNEW, NDIM, NP, TIME)</td></tr>
<tr class="separator:a316d52085cfea0d96fe7dc73723b6723"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a371f9e75b17ed38dce80d4367c4fbde7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motion__type_8f.html#a371f9e75b17ed38dce80d4367c4fbde7">MOVEXYZ_1</a> (XYZ0, XYZNEW, NDIM, NP, TIME)</td></tr>
<tr class="separator:a371f9e75b17ed38dce80d4367c4fbde7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a866652885730fdfe7ba347c79e1f465d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motion__type_8f.html#a866652885730fdfe7ba347c79e1f465d">MOVEXYZ_2</a> (XYZ0, XYZNEW, NDIM, NP, TIME)</td></tr>
<tr class="separator:a866652885730fdfe7ba347c79e1f465d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a571228467a005ca1858910a392bc5e1f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motion__type_8f.html#a571228467a005ca1858910a392bc5e1f">MOVEXYZ_3</a> (XYZ0, XYZNEW, NDIM, NP, TIME)</td></tr>
<tr class="separator:a571228467a005ca1858910a392bc5e1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a720ea85e411776514a01716207b5f420"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motion__type_8f.html#a720ea85e411776514a01716207b5f420">MOVEXYZ_4</a> (XYZ0, XYZNEW, NDIM, NP, TIME)</td></tr>
<tr class="separator:a720ea85e411776514a01716207b5f420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06a641f984b5f42db9df733510cdb971"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motion__type_8f.html#a06a641f984b5f42db9df733510cdb971">MOVEXYZ_5</a> (XYZ0, XYZNEW, NDIM, NP, TIME)</td></tr>
<tr class="separator:a06a641f984b5f42db9df733510cdb971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b8d845fb1fcc937196d0fd135fc2b70"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motion__type_8f.html#a5b8d845fb1fcc937196d0fd135fc2b70">MOVEXYZ_6</a> (XYZ0, XYZNEW, NDIM, NP, TIME)</td></tr>
<tr class="separator:a5b8d845fb1fcc937196d0fd135fc2b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dfb605a6ea8724bde348246f45ef0f8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motion__type_8f.html#a0dfb605a6ea8724bde348246f45ef0f8">MOVEXYZ_7</a> (XYZ0, XYZNEW, NDIM, NP, TIME)</td></tr>
<tr class="separator:a0dfb605a6ea8724bde348246f45ef0f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04a0279c699930f0a41726bcd306c66f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motion__type_8f.html#a04a0279c699930f0a41726bcd306c66f">MOVEXYZ_8</a> (XYZ0, XYZNEW, NDIM, NP, TIME)</td></tr>
<tr class="separator:a04a0279c699930f0a41726bcd306c66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa18bbb34201f26ab63552ce404a6c3a2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="motion__type_8f.html#aa18bbb34201f26ab63552ce404a6c3a2">MOVEXYZ_9</a> (XYZ0, XYZNEW, NDIM, NP, TIME)</td></tr>
<tr class="separator:aa18bbb34201f26ab63552ce404a6c3a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a316d52085cfea0d96fe7dc73723b6723"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a316d52085cfea0d96fe7dc73723b6723">&#9670;&nbsp;</a></span>MOVEXYZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine MOVEXYZ </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZ0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZNEW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>TIME</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Purpose</dt><dd></dd></dl>
<p>Driver routine for moving the grid: the behaviour depends on the integer <code>IALE</code> which is stored in time.com</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZ0</td><td>the coordinates of the fixed grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XYZNEW</td><td>the coordinates of grid at time TIME </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NDIM</td><td>dimension of the space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NP</td><td>number of gridpoints = NPOIN+NGHOST+NPNOD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIME</td><td>the at the end of the current timestep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a371f9e75b17ed38dce80d4367c4fbde7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a371f9e75b17ed38dce80d4367c4fbde7">&#9670;&nbsp;</a></span>MOVEXYZ_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine MOVEXYZ_1 </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZ0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZNEW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>TIME</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Purpose</dt><dd></dd></dl>
<p>Rigidly oscillates the grid horizontally (along x)</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} x^{n+1} &amp;=&amp; x^0 + a\, \int_{0}^{n\,\Delta t}\sin\left(\omega t\right) \; \mathrm{d}t \\\ &amp;=&amp; x^0 + \frac{a}{\omega} \left[1-\cos\left(\omega \, n\,\Delta t\right)\right] \quad n = 0,1,...N \end{eqnarray*}" src="form_76.png"/>
</p>
<p> The period of the oscillation coincides with the total running time <img class="formulaInl" alt="$T$" src="form_237.png"/> so that at time <img class="formulaInl" alt="$ N\Delta t = T $" src="form_77.png"/> the grid will return to its initial position; it follows that <img class="formulaInl" alt="$ \omega = \frac{2\pi}{T} = \frac{2\pi}{N\Delta t} $" src="form_78.png"/></p>
<p>the velocity <img class="formulaInl" alt="$ a$" src="form_252.png"/> is set to 1</p>
<p>Use: </p><pre class="fragment"> -ale_grid_motion_type 1</pre><p> to activate this kind of grid motion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZ0</td><td>the coordinates of the fixed grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XYZNEW</td><td>the coordinates of grid at time TIME </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NDIM</td><td>dimension of the space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NP</td><td>number of gridpoints = NPOIN+NGHOST+NPNOD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIME</td><td>the at the end of the current timestep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a866652885730fdfe7ba347c79e1f465d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a866652885730fdfe7ba347c79e1f465d">&#9670;&nbsp;</a></span>MOVEXYZ_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine MOVEXYZ_2 </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZ0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZNEW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>TIME</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Purpose</dt><dd></dd></dl>
<p>Deforms the grid for the vortex: deforming grid</p>
<p>In particular, we consider a mesh which deforms according to the following mapping: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \left(x^{n+1}-x_0\right) &amp;=&amp; \left(x^0-x_0\right) \left[B_0+A_1\sin\left(\omega t\right)+B_1\cos\left(\omega t\right)\right] \\\ \left(y^{n+1}-y_0\right) &amp;=&amp; \left(y^0-y_0\right) \left[B_0+A_1\sin\left(\omega t\right)+B_1\cos\left(\omega t\right)\right] \end{eqnarray*}" src="form_79.png"/>
</p>
<p>Point <img class="formulaInl" alt="$x_0,y_0$" src="form_85.png"/> is set equal to the initial location of the vortex centre, which can be set at runtime using the option: </p><pre class="fragment"> -ale_motion_origin [x0,y0,z0]</pre><p> One should use:</p><ol type="1">
<li>(x0,y0) = (0.5d0,0.5d0) for the scalar case</li>
<li>(x0,y0) = (0.d0,0.d0) for the compressible vortex case</li>
</ol>
<p>Moreover, we choose <img class="formulaInl" alt="$B_0+B_1 = 1$" src="form_80.png"/> so that the grid is un-deformed at <img class="formulaInl" alt="$t = 0$" src="form_81.png"/> and <img class="formulaInl" alt="$t = T$" src="form_82.png"/> and <img class="formulaInl" alt="$A_1 = 0$" src="form_83.png"/>, for simplicity. Finally, we set: <img class="formulaInl" alt="$B_1 = 1/(3\pi)$" src="form_84.png"/>.</p>
<p>Use: </p><pre class="fragment"> -ale_grid_motion_type 2</pre><p> to activate this kind of grid motion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZ0</td><td>the coordinates of the fixed grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XYZNEW</td><td>the coordinates of grid at time TIME </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NDIM</td><td>dimension of the space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NP</td><td>number of gridpoints = NPOIN+NGHOST+NPNOD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIME</td><td>the at the end of the current timestep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a571228467a005ca1858910a392bc5e1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a571228467a005ca1858910a392bc5e1f">&#9670;&nbsp;</a></span>MOVEXYZ_3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine MOVEXYZ_3 </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZ0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZNEW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>TIME</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Purpose</dt><dd></dd></dl>
<p>Move the grid for the oscillating NACA. When using: </p><pre class="fragment"> -ale_grid move</pre><p> only the grid within an ellipse will be rigidly moved and it will only work with the grid stored in: </p><pre class="fragment"> $HOME/grids/2D/aerofoils/naca0012/euler/NP2355_within_ellipse</pre><p> Otherwise, when using: </p><pre class="fragment"> -ale_grid laplace </pre><p> it will (presumably) work with all NACA0012 grids.</p>
<p>Use </p><pre class="fragment"> -ale_grid_motion_type 3</pre><p> to activate this kind of grid motion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZ0</td><td>the coordinates of the fixed grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XYZNEW</td><td>the coordinates of the grid at time TIME </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NDIM</td><td>dimension of the space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NP</td><td>number of gridpoints = NPOIN+NGHOST+NPNOD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIME</td><td>the at the end of the current timestep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a720ea85e411776514a01716207b5f420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a720ea85e411776514a01716207b5f420">&#9670;&nbsp;</a></span>MOVEXYZ_4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine MOVEXYZ_4 </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZ0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZNEW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>TIME</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Purpose</dt><dd></dd></dl>
<p>Move the grid for the piston in cylinder, using the testcase published here <a href="http://dx.doi.org/doi:10.1002/(SICI)1097-0363(19990815)30:7&lt;865::AID-FLD870&gt;3.0.CO;2-5" title="E. Lefrançois, G. Dhatt, D. Vandromme, International Journal for Numerical Methods in Fluids Volume 30, (7), 1999">FLD870</a></p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_{\mbox{piston}}/L = c + \frac{R}{L}\left[1-\cos\left(\omega^*t^*\right)\right] + \left(\frac{R}{2L}\right)^2\left[1-\cos\left(2\omega^*t^*\right)\right] \]" src="form_133.png"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ t^* = t \frac{\sqrt{ R T^0 }}{L} \]" src="form_134.png"/>
</p>
<p> is the dimensionless time and the dimensionless frequency <img class="formulaInl" alt="$\omega^*$" src="form_135.png"/> is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \omega^* = \Omega \frac{L}{\sqrt{ R T^0 }} \]" src="form_136.png"/>
</p>
<p> the dimensional frequency is <img class="formulaInl" alt="$\Omega$" src="form_137.png"/> = 100 Hz.</p>
<p>grid files are in:</p>
<pre class="fragment"> $GRIDS/2D/misc/piston</pre><p>The remeshing process is made by linear interpolation of node displacement between the fixed wall on the left and the moving wall on the right, i.e.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_i\left(t\right) = \frac{x_i\left(t=0\right)}{x_{\mbox{piston}}\left(t=0\right)} \; x_{\mbox{piston}} \left(t\right) \]" src="form_139.png"/>
</p>
<p>Use: </p><pre class="fragment"> -ale_grid_motion_type 4</pre><p> to activate this kind of grid motion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZ0</td><td>the coordinates of the fixed grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XYZNEW</td><td>the coordinates of the grid at time TIME </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NDIM</td><td>dimension of the space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NP</td><td>number of gridpoints = NPOIN+NGHOST+NPNOD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIME</td><td>the at the end of the current timestep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a06a641f984b5f42db9df733510cdb971"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06a641f984b5f42db9df733510cdb971">&#9670;&nbsp;</a></span>MOVEXYZ_5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine MOVEXYZ_5 </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZ0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZNEW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>TIME</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Purpose</dt><dd></dd></dl>
<p>Move the grid for the Smooth inviscid flow in a piston (2D) testcase from J. Dobes' phD thesis</p>
<p>grid files are in:</p>
<pre class="fragment"> $GRIDS/2D/misc/piston2 
 $GRIDS/3D/misc/piston2 </pre><p>The piston starts to accelerate with derivative of acceleration <img class="formulaInl" alt="$ \left(\frac{\mathrm{d}a}{\mathrm{d}t}\right)_{t=0} = 0.2 $" src="form_149.png"/> so that the trajectory of the piston is:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_{\mbox{piston}} = \left(\frac{\mathrm{d}a}{\mathrm{d}t}\right)_{t=0} \frac{t^3}{6} \]" src="form_150.png"/>
</p>
<p>The numerical solution should be plotted at time t = 4, when the piston has reached position x = 2.133.</p>
<p>The remeshing process is made by linear interpolation of node displacement between the fixed wall on the right and the moving wall on the left, i.e.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_i\left(t\right) = \left(1-\alpha\right) x_{\mbox{piston}} \left(t\right) + \alpha l \]" src="form_151.png"/>
</p>
<p> where: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha = x_i\left(t=0\right)/l \]" src="form_152.png"/>
</p>
<p>in the 3D case it is the <img class="formulaInl" alt="$ z $" src="form_276.png"/> axis that is aligned with the cylinder's axis</p>
<p>Use: </p><pre class="fragment"> -ale_grid_motion_type 5</pre><p> to activate this kind of grid motion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZ0</td><td>the coordinates of the fixed grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XYZNEW</td><td>the coordinates of the grid at time TIME </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NDIM</td><td>dimension of the space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NP</td><td>number of gridpoints = NPOIN+NGHOST+NPNOD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIME</td><td>the at the end of the current timestep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5b8d845fb1fcc937196d0fd135fc2b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b8d845fb1fcc937196d0fd135fc2b70">&#9670;&nbsp;</a></span>MOVEXYZ_6()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine MOVEXYZ_6 </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZ0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZNEW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>TIME</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Purpose</dt><dd></dd></dl>
<p>Move the grid for the expantion due to a smoothly moving piston (2D)</p>
<p>grid files are in:</p>
<pre class="fragment"> $GRIDS/2D/misc/piston3</pre><p>We consider a piston moving (to the left of the origin) with the following velocity: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ v_p\left(t\right) = v_1 \left( 1-\exp\left(-\alpha t\right)\right) \quad\quad\mbox{with}\quad\quad \alpha = 1 \; \mbox{s}^{-1} \]" src="form_238.png"/>
</p>
<p> so that it will approach a constant velocity <img class="formulaInl" alt="$v_1$" src="form_239.png"/> = -75 m/s after a sufficiently long time.</p>
<p>The trajectory of the piston, having set <img class="formulaInl" alt="$t_0 = 0$" src="form_240.png"/> as the initial time, is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_p\left(t\right) = v_1 \left[ t + \frac{1}{\alpha} \left( \exp\left(-\alpha t\right)-1\right)\right] \]" src="form_241.png"/>
</p>
<p>The following settings should be used in the .petscrc file: </p><pre class="fragment"> -nondimensionalisation internal
 -inlet_total_temperature  223.99203583872573419611
 -inlet_total_pressure  2.e5
 -reference_length 1000.
 -inlet_mach_number 0.0</pre><p><img class="formulaInl" alt="$T^0$" src="form_242.png"/> has been chosen in such a way that the sound speed in the cylinder is initially <img class="formulaInl" alt="$a_0$" src="form_243.png"/> = 300 m/s; Total pressure is irrelevant.</p>
<p>Reference quantities are:</p>
<ol type="1">
<li>velocity is <img class="formulaInl" alt="$a_T = \sqrt{R T^0} = a_0/\sqrt{\gamma} $" src="form_244.png"/> = 253.54627641855498 m/s.</li>
<li>time-scale is <img class="formulaInl" alt="$T^* = L/a_T $" src="form_245.png"/> = 3.9440531887330774</li>
</ol>
<p>The numerical solution should be plotted at time <img class="formulaInl" alt="$t_1^* $" src="form_250.png"/> = 0.75 which corresponds to a physical time <img class="formulaInl" alt="$t_1 $" src="form_246.png"/> = 2.958039891549808050 s</p>
<p>The various non-dimensional quantities are therefore: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} v_1^* &amp;=&amp; v_1/a_T = -0.29580398915498080 \\ T^* &amp;=&amp; T/a_T = 3.9440531887330774 \\ \alpha^* &amp;=&amp; \alpha/a_T = 3.9440531887330774 \\ \end{eqnarray*}" src="form_251.png"/>
</p>
<p>The remeshing process is made by linear interpolation of node displacement between the fixed wall on the right and the moving wall on the left, i.e.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_i\left(t\right) = \left(1-\beta\right) x_{\mbox{piston}} \left(t\right) + \beta l \]" src="form_248.png"/>
</p>
<p> where: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \beta = x_i\left(t=0\right)/l \]" src="form_249.png"/>
</p>
<p>Use: </p><pre class="fragment"> -ale_grid_motion_type 6</pre><p> to activate this kind of grid motion/deformation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZ0</td><td>the coordinates of the fixed grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XYZNEW</td><td>the coordinates of the grid at time TIME </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NDIM</td><td>dimension of the space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NP</td><td>number of gridpoints = NPOIN+NGHOST+NPNOD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIME</td><td>at the end of the current timestep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0dfb605a6ea8724bde348246f45ef0f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dfb605a6ea8724bde348246f45ef0f8">&#9670;&nbsp;</a></span>MOVEXYZ_7()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine MOVEXYZ_7 </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZ0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZNEW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>TIME</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZ0</td><td>the coordinates of the fixed grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XYZNEW</td><td>the coordinates of the grid at time TIME </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NDIM</td><td>dimension of the space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NP</td><td>number of gridpoints = NPOIN+NGHOST+NPNOD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIME</td><td>at the end of the current timestep </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Purpose</dt><dd></dd></dl>
<p>Move the grid for the expansion interacting with a moving shock</p>
<p>grid files are in:</p>
<pre class="fragment"> $GRIDS/2D/misc/piston4</pre><p>A planar piston is impulsively set into motion with dimensionless velocity <img class="formulaInl" alt="$v_p^*$" src="form_260.png"/>, so that a shock is created which moves to the right at constant speed <img class="formulaInl" alt="$W$" src="form_261.png"/> = 450 m/s.</p>
<p>The temperature in the undisturbed part of the cylinder is such that the shock Mach number is <img class="formulaInl" alt="$M_{r_1} = W/\sqrt{\gamma\,R\,T_1}$" src="form_262.png"/> = 1.534; it follows that: <img class="formulaInl" alt="$T_1$" src="form_263.png"/> = 214,172830291 K.</p>
<p>We decide to solve the equations in non-dimensional form using the set of reference variables for internal flows: The following settings should be used in the .petscrc file: </p><pre class="fragment"> -nondimensionalisation internal
 -inlet_total_temperature  247.92660034794133
 -inlet_total_pressure  [whatever]
 -reference_length 1.
 -inlet_mach_number [whatever]</pre><p>By doing so, we have to choose a (dimensional) reference temperature and pressure. In the present case, these are set equal to the corresponding (total) quantities in the gas at rest: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p_{\mbox{ref}} = \mbox{whatever} \quad\mbox{and}\quad T_{\mbox{ref}} = T_1 \]" src="form_264.png"/>
</p>
<p> The reference velocity (which is the isothermal sound speed) follows: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_{\mbox{ref}} = \sqrt{R\,T_{\mbox{ref}}} = 247.92660034794133 \; \mbox{m/s} \]" src="form_265.png"/>
</p>
<p> Having set the upstream uniform state as the reference one, the non-dimensional upstream state becomes: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p_1^* = 1 \quad\quad \rho_1^* = 1 \quad\quad T_1^* = 1 \]" src="form_266.png"/>
</p>
<p> using the jump relations in a reference frame moving with the shock, the (non-dimensional) downstream values are found to be: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p_2^* = 2.5786821287522521 \quad\quad \rho_2^* = 1.9201192819084407 \quad\quad T_2^* = 1.3429801747468804. \]" src="form_267.png"/>
</p>
<p> Concerning the shock-downstream velocity, which is the same as the piston velocity, we have: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ v_p = u_2 = W - M_{r_2} a_2 \]" src="form_268.png"/>
</p>
<p> with <img class="formulaInl" alt="$M_{r_2}$" src="form_269.png"/> = 0.68938584364157141. Therefore, the dimensionless piston velocity is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ v_p^* = \frac{u_2}{\sqrt{R T_1}} = \frac{W-M_{r_2} a_2}{\sqrt{R T_1}} = \sqrt{\gamma} \left( M_{r_1} - \sqrt{\frac{T_2}{T_1}} M_{r_2} \right) = 0.86977177750456247 \]" src="form_270.png"/>
</p>
<p> The initial dimensions of the computational domain are: <img class="formulaInl" alt="$[0,5L] \times [0,L]$" src="form_275.png"/>.</p>
<p>At time <img class="formulaInl" alt="$t = 0$" src="form_81.png"/>, when the shock is at <img class="formulaInl" alt="$x/L$" src="form_271.png"/> = 0.3, the piston's speed starts decreasing with the following law: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ v_p^*\left(t\right) = v_p^* \, e^{-t} \]" src="form_272.png"/>
</p>
<p> so that the trajectory of the piston is: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_{\mbox{piston}}/L = v_p^* \, \left(1-e^{-t} \right) \]" src="form_273.png"/>
</p>
<p>The remeshing process is made by linear interpolation of node displacement between the fixed wall on the right and the moving wall on the left, i.e.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_i\left(t\right) = \left(1-\beta\right) x_{\mbox{piston}} \left(t\right) + \beta l \]" src="form_248.png"/>
</p>
<p> where: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \beta = x_i\left(t=0\right)/l \]" src="form_249.png"/>
</p>
<p>Use: </p><pre class="fragment"> -ale_grid_motion_type 7</pre><p> to activate this kind of grid motion/deformation. </p>

</div>
</div>
<a id="a04a0279c699930f0a41726bcd306c66f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04a0279c699930f0a41726bcd306c66f">&#9670;&nbsp;</a></span>MOVEXYZ_8()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine MOVEXYZ_8 </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZ0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZNEW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>TIME</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZ0</td><td>the coordinates of the fixed grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XYZNEW</td><td>the coordinates of the grid at time TIME </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NDIM</td><td>dimension of the space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NP</td><td>number of gridpoints = NPOIN+NGHOST+NPNOD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIME</td><td>at the end of the current timestep </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Purpose</dt><dd></dd></dl>
<p>Move the grid for the centred compression: all <img class="formulaInl" alt="$ \mathcal{C}^+$" src="form_287.png"/> characteristic lines meet in the focal point F; the focal point has dimensionless coordinates: <img class="formulaInl" alt="$ x^*_F, t^*_F $" src="form_289.png"/>.</p>
<p>Grid files are in:</p>
<pre class="fragment"> $GRIDS/2D/misc/piston4/gridlev?</pre><p>The computational domain is the rectangle <img class="formulaInl" alt="$ \left[0,5 \right] \times \left[0,1\right]$" src="form_292.png"/>.</p>
<p>We choose <img class="formulaInl" alt="$ x^*_F = 5 $" src="form_290.png"/> so that <img class="formulaInl" alt="$ t^*_F = x^*_F / a_0^* = 4.22577127364258288756 $" src="form_293.png"/>.</p>
<p>The piston's trajectory, velocity and acceleration are given below:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} x^*_p\left(t\right) &amp;=&amp; x^*_F + \frac{2 \, a_0^*}{\gamma-1} \left(t^*_F-t^*\right) \left\{ 1 - \frac{\gamma+1}{2} \left[ \left(1-\frac{t^*}{t_f}\right)^{-\frac{\gamma-1}{\gamma+1}} \right] \right\} \\ \dot{x}^*_p\left(t\right) &amp;=&amp; \frac{2 a_0^*}{\gamma-1} \left\{ \left(1-\frac{t^*}{t_f}\right)^{-\frac{\gamma-1}{\gamma+1}} -1 \right\} \\ \ddot{x}^*_p\left(t\right) &amp;=&amp; \frac{2 a_0^*}{\gamma+1} \left(1-\frac{t^*}{t_f}\right)^{-\frac{2\,\gamma}{\gamma+1}} \end{eqnarray}" src="form_295.png"/>
</p>
<p>Before the piston is set into motion, the (dimensional) temperature in the cylinder is <img class="formulaInl" alt="$T_0$" src="form_282.png"/> = 273.15 K.</p>
<p>We solve the equations in non-dimensional form using the set of reference variables for internal flows; the following settings should be used in the .petscrc file: </p><pre class="fragment"> -nondimensionalisation internal
 -inlet_total_temperature  273.15
 -inlet_total_pressure  [whatever]
 -reference_length 1.
 -inlet_mach_number 0.d0</pre><p>By doing so, we have to choose a (dimensional) reference temperature and pressure. In the present case, these are set equal to the corresponding (total) quantities in the gas at rest: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p_{\mbox{ref}} = \mbox{whatever} \quad\mbox{and}\quad T_{\mbox{ref}} = T_1 \]" src="form_264.png"/>
</p>
<p> The reference velocity (which is the isothermal sound speed) follows: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_{\mbox{ref}} = \sqrt{R\,T_{\mbox{ref}}} = 247.92660034794133 \; \mbox{m/s} \]" src="form_265.png"/>
</p>
<p> Having set the upstream uniform state as the reference one, the non-dimensional upstream state becomes: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ p_1^* = 1 \quad\quad \rho_1^* = 1 \quad\quad T_1^* = 1 \]" src="form_266.png"/>
</p>
<p>Using characteristic theory, it is not difficult to show that for a given point <img class="formulaInl" alt="$x^*,t^*$" src="form_296.png"/> in the space-time plane</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} u^*\left(x^*,t^*\right) &amp;=&amp; \dot{x}^*_p\left(\tau\right) \\ a^*\left(x^*,t^*\right) &amp;=&amp; a_p\left(\tau\right) = a^*_0 + \delta \dot{x}^*_p\left(\tau\right) \end{eqnarray}" src="form_299.png"/>
</p>
<p><img class="formulaInl" alt="$\tau &lt; t$" src="form_298.png"/> being the time instant when the straight characteristic line passing through <img class="formulaInl" alt="$x^*,t^*$" src="form_296.png"/> meets the piston's trajectory.</p>
<p>In order to find <img class="formulaInl" alt="$\tau^*$" src="form_300.png"/>, one has to solve the following non-linear equation (which represents the equation of the straight characteristic line <img class="formulaInl" alt="$\mathcal{C}^+$" src="form_301.png"/> in the unknown <img class="formulaInl" alt="$\tau^*$" src="form_300.png"/></p>
<p>The remeshing process is made by linear interpolation of node displacement between the fixed wall on the right and the moving wall on the left, i.e.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ x_i\left(t\right) = \left(1-\beta\right) x_{\mbox{piston}} \left(t\right) + \beta l \]" src="form_248.png"/>
</p>
<p> where: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \beta = x_i\left(t=0\right)/l \]" src="form_249.png"/>
</p>
<p>Use: </p><pre class="fragment"> -ale_grid_motion_type 8</pre><p> to activate this kind of grid motion/deformation. </p>

</div>
</div>
<a id="aa18bbb34201f26ab63552ce404a6c3a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa18bbb34201f26ab63552ce404a6c3a2">&#9670;&nbsp;</a></span>MOVEXYZ_9()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine MOVEXYZ_9 </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZ0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(ndim,*)&#160;</td>
          <td class="paramname"><em>XYZNEW</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>NP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision&#160;</td>
          <td class="paramname"><em>TIME</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Purpose</dt><dd></dd></dl>
<p>Move the grid for the pitching and plunging NACA.</p>
<p>The plunging motion is given by: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ h\left(t\right) = h_0 \sin \left(k\,t\right) \]" src="form_351.png"/>
</p>
<p> where: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ h_0 = 0.75 \]" src="form_352.png"/>
</p>
<p> is currently hardwired into the code.</p>
<p>The pitching motion is given by: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \theta\left(t\right) = \theta_0 \sin \left(k\,t+\phi\right) \]" src="form_354.png"/>
</p>
<p> where <img class="formulaInl" alt="$ \theta_0 $" src="form_355.png"/> can be set through the variable <code>APITCH(3)</code> using the runtime option </p><pre class="fragment"> -ale_pitching_amplitude APITCH(1),APITCH(2),APITCH(3)</pre><p> and <img class="formulaInl" alt="$ k$" src="form_356.png"/> can be set through the variable <code>OPITCH(3)</code> using the runtime option: </p><pre class="fragment"> -ale_pitching_omega OPITCH(1),OPITCH(2),OPITCH(3)</pre><p>The phase shift <img class="formulaInl" alt="$ \phi $" src="form_357.png"/> is also currently hardwired into the code and set equal to 0.</p>
<p>Use: </p><pre class="fragment"> -ale_grid laplace</pre><p> to move the grid.</p>
<p>One suitable grid can be found in: </p><pre class="fragment"> $HOME/grids/2D/aerofoils/naca0012/euler/pitching/nohanging/</pre><p>Use </p><pre class="fragment"> -ale_grid_motion_type 9</pre><p> to activate this kind of grid motion.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">XYZ0</td><td>the coordinates of the fixed grid </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">XYZNEW</td><td>the coordinates of the grid at time TIME </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NDIM</td><td>dimension of the space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NP</td><td>number of gridpoints = NPOIN+NGHOST+NPNOD </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TIME</td><td>the at the end of the current timestep </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_405fd32de3649961a5f009c7a3fe84df.html">geometry</a></li><li class="navelem"><a class="el" href="motion__type_8f.html">motion_type.f</a></li>
    <li class="footer">Generated on Sat Apr 25 2020 11:41:44 for eulfs by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
  </ul>
</div>
</body>
</html>
