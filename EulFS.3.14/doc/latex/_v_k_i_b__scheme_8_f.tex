\hypertarget{_v_k_i_b__scheme_8_f}{}\doxysection{src/schemes/\+V\+K\+I\+B\+\_\+scheme.F File Reference}
\label{_v_k_i_b__scheme_8_f}\index{src/schemes/VKIB\_scheme.F@{src/schemes/VKIB\_scheme.F}}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{_v_k_i_b__scheme_8_f_ad36a8f8bbdcf0b7897e6fc37d43295f1}{V\+K\+I\+B\+\_\+\+S\+C\+H\+E\+ME}} (M\+A\+T\+R\+I\+X\+S\+P\+L\+I\+T\+T\+ER, W, \mbox{\hyperlink{nodres_8_f_a91bf670d169b8cb86bcc7bbefde0f978}{N\+O\+D\+R\+ES}}, T\+S\+T\+EP, B\+E\+TA, S\+T\+I\+FC, N\+O\+R\+D\+ER, N\+D\+OF, N\+O\+F\+V\+E\+RT, V\+CN, N\+D\+IM, D\+F\+G\+H\+DU, L\+DJ, C\+E\+L\+R\+ES, S\+O\+U\+R\+CE, I\+E\+L\+EM, M\+A\+T\+R\+I\+X\+\_\+\+A\+S\+S\+E\+M\+B\+LY)
\begin{DoxyCompactList}\small\item\em {\bfseries{V\+K\+I\+B\+\_\+\+S\+C\+H\+E\+ME}} \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{_v_k_i_b__scheme_8_f_ad36a8f8bbdcf0b7897e6fc37d43295f1}\label{_v_k_i_b__scheme_8_f_ad36a8f8bbdcf0b7897e6fc37d43295f1}} 
\index{VKIB\_scheme.F@{VKIB\_scheme.F}!VKIB\_SCHEME@{VKIB\_SCHEME}}
\index{VKIB\_SCHEME@{VKIB\_SCHEME}!VKIB\_scheme.F@{VKIB\_scheme.F}}
\doxysubsubsection{\texorpdfstring{VKIB\_SCHEME()}{VKIB\_SCHEME()}}
{\footnotesize\ttfamily subroutine V\+K\+I\+B\+\_\+\+S\+C\+H\+E\+ME (\begin{DoxyParamCaption}\item[{external}]{M\+A\+T\+R\+I\+X\+S\+P\+L\+I\+T\+T\+ER,  }\item[{double precision, dimension(ndof,nofvert)}]{W,  }\item[{double precision, dimension(ndof,nofvert)}]{N\+O\+D\+R\+ES,  }\item[{double precision, dimension(ndof,nofvert)}]{T\+S\+T\+EP,  }\item[{double precision, dimension($\ast$)}]{B\+E\+TA,  }\item[{double precision, dimension(ndof,ndof,nofvert,nofvert)}]{S\+T\+I\+FC,  }\item[{integer}]{N\+O\+R\+D\+ER,  }\item[{integer}]{N\+D\+OF,  }\item[{integer}]{N\+O\+F\+V\+E\+RT,  }\item[{double precision, dimension(ndim,nofvert)}]{V\+CN,  }\item[{integer}]{N\+D\+IM,  }\item[{double precision, dimension(ldj,$\ast$)}]{D\+F\+G\+H\+DU,  }\item[{integer}]{L\+DJ,  }\item[{double precision, dimension($\ast$)}]{C\+E\+L\+R\+ES,  }\item[{double precision, dimension($\ast$)}]{S\+O\+U\+R\+CE,  }\item[{integer}]{I\+E\+L\+EM,  }\item[{logical}]{M\+A\+T\+R\+I\+X\+\_\+\+A\+S\+S\+E\+M\+B\+LY }\end{DoxyParamCaption})}



{\bfseries{V\+K\+I\+B\+\_\+\+S\+C\+H\+E\+ME}} 

\begin{DoxyParagraph}{Purpose}

\end{DoxyParagraph}
This routine computes the Blended (N+\+L\+D\+A2) system scheme on one tetrahedron; \[ \Phi_i^B = \Phi_i^N + \left( \begin{array}{llll} \alpha_1 & 0 & ... & 0 \\ 0 & \alpha_2 & ... & 0 \\ 0 & 0 & ... & \alpha_m \end{array} \right) \left( \Phi_i^{LDA_2} - \Phi_i^N \right) \]

the distribution matrix for the L\+DA version 2 scheme reads\+: \[ B_i^{LDA_2} = K_i^+ N^{-1} \quad\quad \mbox{where} \quad\quad N = \left( \sum_{j=1}^{d+1} K_j^+ \right) \]

so that\+:

\[ \Phi_i^{LDA_2} = -K_i^+ \left( U_{+} - U_{-} \right) \]

whereas, for the first-\/order-\/accurate N scheme\+:

\[ \Phi_i^{N} = -K_i^+ \left( U_i - U_{-} \right) \]

\[ \Phi^{B}_i = -K_i^+ \left( U_i - U_{-} \right) + \left( \begin{array}{llll} \alpha_1 & 0 & ... & 0 \\ 0 & \alpha_2 & ... & 0 \\ 0 & 0 & ... & \alpha_m \end{array} \right) K_i^+ \left( U_i - U_{+} \right) \]

\[ \alpha = 1 - \frac{|\sum_{j=1}^{d+1} \phi_j^N|}{\sum_{j=1}^{d+1} |\phi_j^N|} \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em M\+A\+T\+R\+I\+X\+S\+P\+L\+I\+T\+T\+ER} & is the subroutine use to split the Jacobian matrix \\
\hline
\mbox{\texttt{ in}}  & {\em W} & is the set of N\+O\+R\+D\+ER dependent variables in the N\+O\+F\+V\+E\+RT vertices of the current cell \\
\hline
\mbox{\texttt{ out}}  & {\em N\+O\+D\+R\+ES} & are the signals sent to each of the N\+O\+F\+V\+E\+RT vertices \\
\hline
\mbox{\texttt{ in,out}}  & {\em T\+S\+T\+EP} & is the elemental contribution to the (inverse of the) time step \\
\hline
\mbox{\texttt{ out}}  & {\em B\+E\+TA} & the N\+O\+F\+V\+E\+RT distribution matrices \\
\hline
\mbox{\texttt{ out}}  & {\em S\+T\+I\+FC} & the elemental contribution to the implicit matrix (computed only if M\+A\+T\+R\+I\+X\+\_\+\+A\+S\+S\+E\+M\+B\+LY is true) \\
\hline
\mbox{\texttt{ in}}  & {\em N\+O\+R\+D\+ER} & is the order of the hyperbolic system being solved, it could be $<$ than N\+D\+OF \\
\hline
\mbox{\texttt{ in}}  & {\em N\+D\+OF} & is the number of dofs in the gridpoints, also the leading dimension of W, S\+T\+I\+FC, N\+O\+D\+R\+ES, T\+S\+T\+EP \\
\hline
\mbox{\texttt{ out}}  & {\em N\+O\+F\+V\+E\+RT} & is number of vertices of the simplicial elements (= N\+D\+I\+M+1) \\
\hline
\mbox{\texttt{ in}}  & {\em V\+CN} & the N\+D\+IM cartesian component of the inward face normal to all N\+O\+F\+V\+E\+RT vertices, scaled by its measure \\
\hline
\mbox{\texttt{ in}}  & {\em N\+D\+IM} & is the dimension of the space \\
\hline
\mbox{\texttt{ in}}  & {\em D\+F\+G\+H\+DU} & the N\+D\+IM cartesian components of the Jacobian matrix \\
\hline
\mbox{\texttt{ in}}  & {\em L\+DJ} & is the leading dimension of D\+F\+G\+H\+DU \\
\hline
\mbox{\texttt{ out}}  & {\em C\+E\+L\+R\+ES} & the elemental residual $ = -\Phi = \sum_{k=j}^{d+1} K_j U_j $ \\
\hline
\mbox{\texttt{ in}}  & {\em S\+O\+U\+R\+CE} & the elemental source term $ = -\int S \mathrm{d}V $ \\
\hline
\mbox{\texttt{ in}}  & {\em I\+E\+L\+EM} & is the current simplicial element \\
\hline
\mbox{\texttt{ in}}  & {\em M\+A\+T\+R\+I\+X\+\_\+\+A\+S\+S\+E\+M\+B\+LY} & when set == .T\+R\+UE. the S\+T\+I\+FC matrix will be assembled \\
\hline
\end{DoxyParams}
\begin{DoxyAuthor}{Author}

\end{DoxyAuthor}
\begin{DoxyParagraph}{Author}
abonfi 
\end{DoxyParagraph}
\begin{DoxyVersion}{Version}

\end{DoxyVersion}
\begin{DoxyParagraph}{Revision}
1.\+12 
\end{DoxyParagraph}
\begin{DoxyDate}{Date}

\end{DoxyDate}
\begin{DoxyParagraph}{Date}
2020/03/28 09\+:49\+:28 
\end{DoxyParagraph}
