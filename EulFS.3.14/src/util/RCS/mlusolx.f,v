head	1.1;
access;
symbols
	release3_14_0:1.1
	release3_13_0:1.1
	release3_12_0:1.1
	release3_11_0:1.1
	release3_10_0:1.1
	release3_8_0:1.1
	release3_7_1:1.1
	release3_7_0:1.1
	release3_4_5:1.1
	release3_4_4:1.1
	release3_4_3:1.1
	release3_4_2:1.1
	release3_4_1:1.1
	release3_4_0:1.1
	release3_3_5:1.1
	release3_3_4:1.1
	release3_3_3:1.1
	release3_3_2:1.1
	release3_3_0:1.1
	release3_3_1:1.1;
locks; strict;
comment	@c @;


1.1
date	2013.01.24.08.33.30;	author abonfi;	state Exp;
branches;
next	;


desc
@Solution of a linear system with loop un-rolling
@


1.1
log
@Initial revision
@
text
@      SUBROUTINE MLUSOLX(A,B,C,ORDER)
c...
c...
      IMPLICIT NONE 
c...
c...
C     .. Scalar Arguments ..
      INTEGER ORDER
C     ..
C     .. Array Arguments ..
      REAL*8 A(ORDER,ORDER),B(ORDER,ORDER),C(ORDER,ORDER)
C     ..
C     .. Local Scalars ..
      REAL*8 SUM1,SUM2,SUM3,SUM4,SUM5,TEMP
C     ..
      GOTO(200,300,400,500)ORDER-1
  200 CONTINUE
       TEMP=1.d0/A(1,1)
       C(1,1) = B(1,1)*TEMP
       C(1,2) = B(1,2)*TEMP
       SUM1 = B(2,1)
       SUM2 = B(2,2)
       SUM1 = SUM1 - A(2,1)*C(1,1)
       SUM2 = SUM2 - A(2,1)*C(1,2)
       TEMP=1.d0/A(2,2)
       C(2,1) = SUM1*TEMP
       C(2,2) = SUM2*TEMP
       SUM1 = C(1,1)
       SUM2 = C(1,2)
       SUM1 = SUM1 - A(1,2)*C(2,1)
       SUM2 = SUM2 - A(1,2)*C(2,2)
       C(1,1) = SUM1
       C(1,2) = SUM2
      RETURN
  300 CONTINUE
       TEMP=1.d0/A(1,1)
       C(1,1) = B(1,1)*TEMP
       C(1,2) = B(1,2)*TEMP
       C(1,3) = B(1,3)*TEMP
       SUM1 = B(2,1)
       SUM2 = B(2,2)
       SUM3 = B(2,3)
       SUM1 = SUM1 - A(2,1)*C(1,1)
       SUM2 = SUM2 - A(2,1)*C(1,2)
       SUM3 = SUM3 - A(2,1)*C(1,3)
       TEMP=1.d0/A(2,2)
       C(2,1) = SUM1*TEMP
       C(2,2) = SUM2*TEMP
       C(2,3) = SUM3*TEMP
       SUM1 = B(3,1)
       SUM2 = B(3,2)
       SUM3 = B(3,3)
       SUM1 = SUM1 - A(3,1)*C(1,1)
       SUM1 = SUM1 - A(3,2)*C(2,1)
       SUM2 = SUM2 - A(3,1)*C(1,2)
       SUM2 = SUM2 - A(3,2)*C(2,2)
       SUM3 = SUM3 - A(3,1)*C(1,3)
       SUM3 = SUM3 - A(3,2)*C(2,3)
       TEMP=1.d0/A(3,3)
       C(3,1) = SUM1*TEMP
       C(3,2) = SUM2*TEMP
       C(3,3) = SUM3*TEMP
       SUM1 = C(2,1)
       SUM2 = C(2,2)
       SUM3 = C(2,3)
       SUM1 = SUM1 - A(2,3)*C(3,1)
       SUM2 = SUM2 - A(2,3)*C(3,2)
       SUM3 = SUM3 - A(2,3)*C(3,3)
       C(2,1) = SUM1
       C(2,2) = SUM2
       C(2,3) = SUM3
       SUM1 = C(1,1)
       SUM2 = C(1,2)
       SUM3 = C(1,3)
       SUM1 = SUM1 - A(1,3)*C(3,1)
       SUM2 = SUM2 - A(1,3)*C(3,2)
       SUM3 = SUM3 - A(1,3)*C(3,3)
       SUM1 = SUM1 - A(1,2)*C(2,1)
       SUM2 = SUM2 - A(1,2)*C(2,2)
       SUM3 = SUM3 - A(1,2)*C(2,3)
       C(1,1) = SUM1
       C(1,2) = SUM2
       C(1,3) = SUM3
      RETURN
  400 CONTINUE
       TEMP=1.d0/A(1,1)
       C(1,1) = B(1,1)*TEMP
       C(1,2) = B(1,2)*TEMP
       C(1,3) = B(1,3)*TEMP
       C(1,4) = B(1,4)*TEMP
       SUM1 = B(2,1)
       SUM2 = B(2,2)
       SUM3 = B(2,3)
       SUM4 = B(2,4)
       SUM1 = SUM1 - A(2,1)*C(1,1)
       SUM2 = SUM2 - A(2,1)*C(1,2)
       SUM3 = SUM3 - A(2,1)*C(1,3)
       SUM4 = SUM4 - A(2,1)*C(1,4)
       TEMP=1.d0/A(2,2)
       C(2,1) = SUM1*TEMP
       C(2,2) = SUM2*TEMP
       C(2,3) = SUM3*TEMP
       C(2,4) = SUM4*TEMP
       SUM1 = B(3,1)
       SUM2 = B(3,2)
       SUM3 = B(3,3)
       SUM4 = B(3,4)
       SUM1 = SUM1 - A(3,1)*C(1,1)
       SUM1 = SUM1 - A(3,2)*C(2,1)
       SUM2 = SUM2 - A(3,1)*C(1,2)
       SUM2 = SUM2 - A(3,2)*C(2,2)
       SUM3 = SUM3 - A(3,1)*C(1,3)
       SUM3 = SUM3 - A(3,2)*C(2,3)
       SUM4 = SUM4 - A(3,1)*C(1,4)
       SUM4 = SUM4 - A(3,2)*C(2,4)
       TEMP=1.d0/A(3,3)
       C(3,1) = SUM1*TEMP
       C(3,2) = SUM2*TEMP
       C(3,3) = SUM3*TEMP
       C(3,4) = SUM4*TEMP
       SUM1 = B(4,1)
       SUM2 = B(4,2)
       SUM3 = B(4,3)
       SUM4 = B(4,4)
       SUM1 = SUM1 - A(4,1)*C(1,1)
       SUM1 = SUM1 - A(4,2)*C(2,1)
       SUM1 = SUM1 - A(4,3)*C(3,1)
       SUM2 = SUM2 - A(4,1)*C(1,2)
       SUM2 = SUM2 - A(4,2)*C(2,2)
       SUM2 = SUM2 - A(4,3)*C(3,2)
       SUM3 = SUM3 - A(4,1)*C(1,3)
       SUM3 = SUM3 - A(4,2)*C(2,3)
       SUM3 = SUM3 - A(4,3)*C(3,3)
       SUM4 = SUM4 - A(4,1)*C(1,4)
       SUM4 = SUM4 - A(4,2)*C(2,4)
       SUM4 = SUM4 - A(4,3)*C(3,4)
       TEMP=1.d0/A(4,4)
       C(4,1) = SUM1*TEMP
       C(4,2) = SUM2*TEMP
       C(4,3) = SUM3*TEMP
       C(4,4) = SUM4*TEMP
       SUM1 = C(3,1)
       SUM2 = C(3,2)
       SUM3 = C(3,3)
       SUM4 = C(3,4)
       SUM1 = SUM1 - A(3,4)*C(4,1)
       SUM2 = SUM2 - A(3,4)*C(4,2)
       SUM3 = SUM3 - A(3,4)*C(4,3)
       SUM4 = SUM4 - A(3,4)*C(4,4)
       C(3,1) = SUM1
       C(3,2) = SUM2
       C(3,3) = SUM3
       C(3,4) = SUM4
       SUM1 = C(2,1)
       SUM2 = C(2,2)
       SUM3 = C(2,3)
       SUM4 = C(2,4)
       SUM1 = SUM1 - A(2,4)*C(4,1)
       SUM2 = SUM2 - A(2,4)*C(4,2)
       SUM3 = SUM3 - A(2,4)*C(4,3)
       SUM4 = SUM4 - A(2,4)*C(4,4)
       SUM1 = SUM1 - A(2,3)*C(3,1)
       SUM2 = SUM2 - A(2,3)*C(3,2)
       SUM3 = SUM3 - A(2,3)*C(3,3)
       SUM4 = SUM4 - A(2,3)*C(3,4)
       C(2,1) = SUM1
       C(2,2) = SUM2
       C(2,3) = SUM3
       C(2,4) = SUM4
       SUM1 = C(1,1)
       SUM2 = C(1,2)
       SUM3 = C(1,3)
       SUM4 = C(1,4)
       SUM1 = SUM1 - A(1,4)*C(4,1)
       SUM2 = SUM2 - A(1,4)*C(4,2)
       SUM3 = SUM3 - A(1,4)*C(4,3)
       SUM4 = SUM4 - A(1,4)*C(4,4)
       SUM1 = SUM1 - A(1,3)*C(3,1)
       SUM2 = SUM2 - A(1,3)*C(3,2)
       SUM3 = SUM3 - A(1,3)*C(3,3)
       SUM4 = SUM4 - A(1,3)*C(3,4)
       SUM1 = SUM1 - A(1,2)*C(2,1)
       SUM2 = SUM2 - A(1,2)*C(2,2)
       SUM3 = SUM3 - A(1,2)*C(2,3)
       SUM4 = SUM4 - A(1,2)*C(2,4)
       C(1,1) = SUM1
       C(1,2) = SUM2
       C(1,3) = SUM3
       C(1,4) = SUM4
       RETURN
  500 CONTINUE
       TEMP=1.d0/A(1,1)
       C(1,1) = B(1,1)*TEMP
       C(1,2) = B(1,2)*TEMP
       C(1,3) = B(1,3)*TEMP
       C(1,4) = B(1,4)*TEMP
       C(1,5) = B(1,5)*TEMP
       SUM1 = B(2,1)
       SUM2 = B(2,2)
       SUM3 = B(2,3)
       SUM4 = B(2,4)
       SUM5 = B(2,5)
       SUM1 = SUM1 - A(2,1)*C(1,1)
       SUM2 = SUM2 - A(2,1)*C(1,2)
       SUM3 = SUM3 - A(2,1)*C(1,3)
       SUM4 = SUM4 - A(2,1)*C(1,4)
       SUM5 = SUM5 - A(2,1)*C(1,5)
       TEMP=1.d0/A(2,2)
       C(2,1) = SUM1*TEMP
       C(2,2) = SUM2*TEMP
       C(2,3) = SUM3*TEMP
       C(2,4) = SUM4*TEMP
       C(2,5) = SUM5*TEMP
       SUM1 = B(3,1)
       SUM2 = B(3,2)
       SUM3 = B(3,3)
       SUM4 = B(3,4)
       SUM5 = B(3,5)
       SUM1 = SUM1 - A(3,1)*C(1,1)
       SUM1 = SUM1 - A(3,2)*C(2,1)
       SUM2 = SUM2 - A(3,1)*C(1,2)
       SUM2 = SUM2 - A(3,2)*C(2,2)
       SUM3 = SUM3 - A(3,1)*C(1,3)
       SUM3 = SUM3 - A(3,2)*C(2,3)
       SUM4 = SUM4 - A(3,1)*C(1,4)
       SUM4 = SUM4 - A(3,2)*C(2,4)
       SUM5 = SUM5 - A(3,1)*C(1,5)
       SUM5 = SUM5 - A(3,2)*C(2,5)
       TEMP=1.d0/A(3,3)
       C(3,1) = SUM1*TEMP
       C(3,2) = SUM2*TEMP
       C(3,3) = SUM3*TEMP
       C(3,4) = SUM4*TEMP
       C(3,5) = SUM5*TEMP
       SUM1 = B(4,1)
       SUM2 = B(4,2)
       SUM3 = B(4,3)
       SUM4 = B(4,4)
       SUM5 = B(4,5)
       SUM1 = SUM1 - A(4,1)*C(1,1)
       SUM1 = SUM1 - A(4,2)*C(2,1)
       SUM1 = SUM1 - A(4,3)*C(3,1)
       SUM2 = SUM2 - A(4,1)*C(1,2)
       SUM2 = SUM2 - A(4,2)*C(2,2)
       SUM2 = SUM2 - A(4,3)*C(3,2)
       SUM3 = SUM3 - A(4,1)*C(1,3)
       SUM3 = SUM3 - A(4,2)*C(2,3)
       SUM3 = SUM3 - A(4,3)*C(3,3)
       SUM4 = SUM4 - A(4,1)*C(1,4)
       SUM4 = SUM4 - A(4,2)*C(2,4)
       SUM4 = SUM4 - A(4,3)*C(3,4)
       SUM5 = SUM5 - A(4,1)*C(1,5)
       SUM5 = SUM5 - A(4,2)*C(2,5)
       SUM5 = SUM5 - A(4,3)*C(3,5)
       TEMP=1.d0/A(4,4)
       C(4,1) = SUM1*TEMP
       C(4,2) = SUM2*TEMP
       C(4,3) = SUM3*TEMP
       C(4,4) = SUM4*TEMP
       C(4,5) = SUM5*TEMP
       SUM1 = B(5,1)
       SUM2 = B(5,2)
       SUM3 = B(5,3)
       SUM4 = B(5,4)
       SUM5 = B(5,5)
       SUM1 = SUM1 - A(5,1)*C(1,1)
       SUM1 = SUM1 - A(5,2)*C(2,1)
       SUM1 = SUM1 - A(5,3)*C(3,1)
       SUM1 = SUM1 - A(5,4)*C(4,1)
       SUM2 = SUM2 - A(5,1)*C(1,2)
       SUM2 = SUM2 - A(5,2)*C(2,2)
       SUM2 = SUM2 - A(5,3)*C(3,2)
       SUM2 = SUM2 - A(5,4)*C(4,2)
       SUM3 = SUM3 - A(5,1)*C(1,3)
       SUM3 = SUM3 - A(5,2)*C(2,3)
       SUM3 = SUM3 - A(5,3)*C(3,3)
       SUM3 = SUM3 - A(5,4)*C(4,3)
       SUM4 = SUM4 - A(5,1)*C(1,4)
       SUM4 = SUM4 - A(5,2)*C(2,4)
       SUM4 = SUM4 - A(5,3)*C(3,4)
       SUM4 = SUM4 - A(5,4)*C(4,4)
       SUM5 = SUM5 - A(5,1)*C(1,5)
       SUM5 = SUM5 - A(5,2)*C(2,5)
       SUM5 = SUM5 - A(5,3)*C(3,5)
       SUM5 = SUM5 - A(5,4)*C(4,5)
       TEMP=1.d0/A(5,5)
       C(5,1) = SUM1*TEMP
       C(5,2) = SUM2*TEMP
       C(5,3) = SUM3*TEMP
       C(5,4) = SUM4*TEMP
       C(5,5) = SUM5*TEMP
       SUM1 = C(4,1)
       SUM2 = C(4,2)
       SUM3 = C(4,3)
       SUM4 = C(4,4)
       SUM5 = C(4,5)
       SUM1 = SUM1 - A(4,5)*C(5,1)
       SUM2 = SUM2 - A(4,5)*C(5,2)
       SUM3 = SUM3 - A(4,5)*C(5,3)
       SUM4 = SUM4 - A(4,5)*C(5,4)
       SUM5 = SUM5 - A(4,5)*C(5,5)
       C(4,1) = SUM1
       C(4,2) = SUM2
       C(4,3) = SUM3
       C(4,4) = SUM4
       C(4,5) = SUM5
       SUM1 = C(3,1)
       SUM2 = C(3,2)
       SUM3 = C(3,3)
       SUM4 = C(3,4)
       SUM5 = C(3,5)
       SUM1 = SUM1 - A(3,5)*C(5,1)
       SUM2 = SUM2 - A(3,5)*C(5,2)
       SUM3 = SUM3 - A(3,5)*C(5,3)
       SUM4 = SUM4 - A(3,5)*C(5,4)
       SUM5 = SUM5 - A(3,5)*C(5,5)
       SUM1 = SUM1 - A(3,4)*C(4,1)
       SUM2 = SUM2 - A(3,4)*C(4,2)
       SUM3 = SUM3 - A(3,4)*C(4,3)
       SUM4 = SUM4 - A(3,4)*C(4,4)
       SUM5 = SUM5 - A(3,4)*C(4,5)
       C(3,1) = SUM1
       C(3,2) = SUM2
       C(3,3) = SUM3
       C(3,4) = SUM4
       C(3,5) = SUM5
       SUM1 = C(2,1)
       SUM2 = C(2,2)
       SUM3 = C(2,3)
       SUM4 = C(2,4)
       SUM5 = C(2,5)
       SUM1 = SUM1 - A(2,5)*C(5,1)
       SUM2 = SUM2 - A(2,5)*C(5,2)
       SUM3 = SUM3 - A(2,5)*C(5,3)
       SUM4 = SUM4 - A(2,5)*C(5,4)
       SUM5 = SUM5 - A(2,5)*C(5,5)
       SUM1 = SUM1 - A(2,4)*C(4,1)
       SUM2 = SUM2 - A(2,4)*C(4,2)
       SUM3 = SUM3 - A(2,4)*C(4,3)
       SUM4 = SUM4 - A(2,4)*C(4,4)
       SUM5 = SUM5 - A(2,4)*C(4,5)
       SUM1 = SUM1 - A(2,3)*C(3,1)
       SUM2 = SUM2 - A(2,3)*C(3,2)
       SUM3 = SUM3 - A(2,3)*C(3,3)
       SUM4 = SUM4 - A(2,3)*C(3,4)
       SUM5 = SUM5 - A(2,3)*C(3,5)
       C(2,1) = SUM1
       C(2,2) = SUM2
       C(2,3) = SUM3
       C(2,4) = SUM4
       C(2,5) = SUM5
       SUM1 = C(1,1)
       SUM2 = C(1,2)
       SUM3 = C(1,3)
       SUM4 = C(1,4)
       SUM5 = C(1,5)
       SUM1 = SUM1 - A(1,5)*C(5,1)
       SUM2 = SUM2 - A(1,5)*C(5,2)
       SUM3 = SUM3 - A(1,5)*C(5,3)
       SUM4 = SUM4 - A(1,5)*C(5,4)
       SUM5 = SUM5 - A(1,5)*C(5,5)
       SUM1 = SUM1 - A(1,4)*C(4,1)
       SUM2 = SUM2 - A(1,4)*C(4,2)
       SUM3 = SUM3 - A(1,4)*C(4,3)
       SUM4 = SUM4 - A(1,4)*C(4,4)
       SUM5 = SUM5 - A(1,4)*C(4,5)
       SUM1 = SUM1 - A(1,3)*C(3,1)
       SUM2 = SUM2 - A(1,3)*C(3,2)
       SUM3 = SUM3 - A(1,3)*C(3,3)
       SUM4 = SUM4 - A(1,3)*C(3,4)
       SUM5 = SUM5 - A(1,3)*C(3,5)
       SUM1 = SUM1 - A(1,2)*C(2,1)
       SUM2 = SUM2 - A(1,2)*C(2,2)
       SUM3 = SUM3 - A(1,2)*C(2,3)
       SUM4 = SUM4 - A(1,2)*C(2,4)
       SUM5 = SUM5 - A(1,2)*C(2,5)
       C(1,1) = SUM1
       C(1,2) = SUM2
       C(1,3) = SUM3
       C(1,4) = SUM4
       C(1,5) = SUM5
C
       RETURN
       END
@
